function [handles, allVertices] = filteringplotMultipleOFFWithHighlights(filenames, fileColors, highlightIndices, highlightColors)
    %figure; % Create a new figure
    hold on; % Hold on to plot multiple datasets

    handles = cell(1, length(filenames)); % Initialize a cell array to store handles
    allVertices = cell(1, length(filenames)); % Store vertices of each file

    % Loop through each file, plot it, and then highlight the specified vertices
    filename = filenames{1};
    color = fileColors{1};

    % Open the file
    fileID = fopen(filename, 'r');

    % Read the first line to get 'OFF'
    fgets(fileID);

    % Read the second line for the counts
    counts = sscanf(fgets(fileID), '%d %d %d');
    numVertices = counts(1);
    numFaces = counts(2);

    % Read the vertices
    vertices = fscanf(fileID, '%f', [3, numVertices])';

    % Store the vertices for data tip use
    allVertices{1} = vertices;

    % Read the faces (assuming 3 vertices per face)
    faces = fscanf(fileID, '%d %d %d %d', [4, numFaces])';
    faces = faces(:, 2:end) + 1; % Adjust for MATLAB indexing

    % Close the file
    fclose(fileID);

    % filtering process
    subsetIndices = [   2,   16,   17,   25,   28,   29,   34,   35,   36,   37,   38,...
         39,   40,   41,   42,   43,   44,   51,   54,   56,   58,   59,...
         60,   61,   62,   63,   64,   65,   66,   67,   68,   70,   73,...
         74,   79,   80,   83,  109,  114,  115,  116,  117,  119,  120,...
        121,  122,  125,  127,  129,  130,  132,  133,  134,  135,  136,...
        137,  138,  139,  140,  141,  142,  143,  144,  174,  175,  176,...
        177,  183,  184,  185,  186,  187,  188,  189,  190,  191,  192,...
        193,  194,  195,  198,  199,  202,  210,  213,  215,  218,  219,...
        221,  222,  223,  224,  225,  226,  227,  229,  230,  233,  234,...
        235,  237,  238,  261,  264,  267,  268,  270,  272,  274,  277,...
        279,  280,  281,  282,  283,  284,  285,  286,  287,  288,  289,...
        290,  291,  292,  293,  295,  296,  305,  310,  311,  315,  316,...
        317,  318,  320,  321,  322,  323,  324,  325,  326,  327,  328,...
        329,  330,  331,  332,  333,  334,  337,  338,  342,  344,  347,...
        374,  379,  384,  385,  386,  387,  392,  393,  394,  395,  396,...
        397,  398,  399,  400,  401,  402,  403,  404,  405,  406,  408,...
        409,  410,  416,  417,  418,  419,  420,  424,  425,  428,  429,...
        430,  431,  434,  435,  436,  437,  438,  439,  440,  441,  442,...
        443,  444,  445,  446,  447,  448,  449,  450,  452,  453,  485,...
        488,  495,  496,  497,  500,  504,  505,  506,  507,  509,  510,...
        511,  512,  513,  514,  515,  516,  517,  518,  519,  520,  521,...
        522,  523,  524,  526,  527,  528,  529,  530,  533,  534,  535,...
        536,  537,  538,  539,  540,  541,  543,  544,  545,  546,  547,...
        551,  552,  553,  557,  558,  559,  562,  566,  569,  570,  571,...
        573,  574,  576,  577,  578,  579,  580,  581,  582,  583,  584,...
        585,  586,  587,  588,  589,  590,  591,  592,  593,  594,  595,...
        596,  597,  598,  599,  600,  601,  606,  608,  609,  633,  634,...
        635,  636,  637,  638,  639,  640,  641,  642,  643,  644,  645,...
        646,  648,  649,  650,  651,  652,  653,  654,  656,  657,  658,...
        659,  660,  661,  664,  666,  667,  669,  670,  671,  672,  673,...
        674,  675,  676,  678,  679,  680,  681,  683,  684,  685,  686,...
        687,  688,  689,  690,  692,  693,  694,  695,  696,  697,  698,...
        699,  700,  701,  702,  703,  704,  705,  706,  707,  708,  709,...
        710,  711,  712,  713,  714,  715,  716,  717,  720,  721,  722,...
        723,  724,  725,  728,  729,  730,  731,  732,  735,  736,  737,...
        738,  739,  741,  742,  744,  745,  746,  748,  749,  751,  752,...
        753,  755,  756,  757,  759,  760,  761,  762,  763,  764,  765,...
        768,  769,  770,  771,  772,  773,  774,  775,  776,  777,  778,...
        779,  780,  781,  782,  783,  784,  785,  786,  787,  788,  789,...
        790,  791,  792,  793,  794,  795,  796,  797,  798,  799,  800,...
        801,  802,  803,  804,  805,  806,  807,  808,  809,  810,  811,...
        812,  813,  814,  815,  816,  817,  818,  819,  820,  821,  822,...
        823,  824,  825,  826,  827,  828,  829,  830,  831,  832,  833,...
        834,  835,  836,  837,  838,  839,  840,  841,  842,  843,  844,...
        845,  846,  847,  848,  849,  850,  851,  852,  853,  854,  855,...
        856,  857,  858,  859,  860,  861,  862,  863,  864,  865,  866,...
        867,  868,  869,  870,  871,  872,  873,  874,  875,  876,  877,...
        878,  879,  880,  881,  882,  883,  884,  885,  886,  887,  888,...
        889,  890,  891,  892,  893,  894,  895,  896,  897,  898,  899,...
        900,  901,  902,  903,  904,  905,  906,  907,  908,  909,  910,...
        911,  912,  913,  914,  915,  916,  917,  918,  919,  920,  921,...
        922,  923,  924,  925,  926,  927,  928,  929,  930,  931,  932,...
        933,  934,  935,  936,  937,  938,  939,  940,  941,  942,  943,...
        944,  945,  946,  947,  948,  949,  950,  951,  952,  953,  954,...
        955,  956,  957,  958,  959,  960,  961,  962,  963,  964,  965,...
        966,  967,  968,  969,  970,  971,  972,  973,  974,  975,  976,...
        977,  978,  979,  980,  981,  982,  983,  984,  985,  986,  987,...
        988,  989,  990,  991,  992,  993,  994,  995,  996,  997,  998,...
        999, 1000, 1001];

    % Adjust the subset indices for MATLAB indexing if necessary
    % (only if your subset indices are 0-based)
    subsetIndices = subsetIndices + 1;

    % Initialize a logical array to identify relevant faces
    relevantFaces = false(size(faces, 1), 1);

    % Loop through each face to check if it contains a vertex from the subset
    for i = 1:size(faces, 1)
        if any(ismember(faces(i,:), subsetIndices))
          relevantFaces(i) = true;
        end
    end

    % Filter the faces array to include only relevant faces
    filteredFaces = faces(relevantFaces, :);

    % Plotting the surface
    trisurf(filteredFaces, vertices(:,1), vertices(:,2), vertices(:,3), ...
            'FaceColor', color, 'EdgeColor', 'none', 'FaceAlpha', 0.2);

    % Store the handle of the plot
    % handles{i} = plot3(vertices(:,1), vertices(:,2), vertices(:,3), ...
           % '.', 'MarkerSize', 5, 'Color', 0.8*[1, 1, 1], 'MarkerFaceColor', 0.8*[1, 1, 1]);

    % Highlighting specified vertices for this file
    plot3(vertices(highlightIndices{1},1), vertices(highlightIndices{1},2), vertices(highlightIndices{1},3), ...
          'o', 'MarkerSize', 5, 'MarkerEdgeColor', highlightColors{1},'MarkerFaceColor', highlightColors{1});

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    filename = filenames{2};
    color = fileColors{2};

    % Open the file
    fileID = fopen(filename, 'r');

    % Read the first line to get 'OFF'
    fgets(fileID);

    % Read the second line for the counts
    counts = sscanf(fgets(fileID), '%d %d %d');
    numVertices = counts(1);
    numFaces = counts(2);

    % Read the vertices
    vertices = fscanf(fileID, '%f', [3, numVertices])';

    % Store the vertices for data tip use
    allVertices{2} = vertices;

    % Read the faces (assuming 3 vertices per face)
    faces = fscanf(fileID, '%d %d %d %d', [4, numFaces])';
    faces = faces(:, 2:end) + 1; % Adjust for MATLAB indexing

    % Close the file
    fclose(fileID);

    % Plotting the surface
    trisurf(faces, vertices(:,1), vertices(:,2), vertices(:,3), ...
            'FaceColor', color, 'EdgeColor', 'none', 'FaceAlpha', 0.2);

    % Store the handle of the plot
    % handles{i} = plot3(vertices(:,1), vertices(:,2), vertices(:,3), ...
           % '.', 'MarkerSize', 5, 'Color', 0.8*[1, 1, 1], 'MarkerFaceColor', 0.8*[1, 1, 1]);

    % Highlighting specified vertices for this file
    plot3(vertices(highlightIndices{2},1), vertices(highlightIndices{2},2), vertices(highlightIndices{2},3), ...
          'o', 'MarkerSize', 5, 'MarkerEdgeColor', highlightColors{2},'MarkerFaceColor', highlightColors{2});

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Enhance the plot
    camlight; lighting phong; axis equal;
    % xlabel('X-axis'); ylabel('Y-axis'); zlabel('Z-axis');
    %title('3D Surface Plots with Highlights from Multiple .OFF Files');
    camproj('perspective');
    % Set axis limits
    xlim([-1.5, 3]);
    ylim([-1, 1]);
    zlim([-0.6, 0.6]);

    % hide
    axis off;

    hold off;
end
